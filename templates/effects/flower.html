<div id="container"></div>

<style>

* {
  cursor: url('../../cur/Sapphire_Normal.cur') 2 2, auto;
}

#container {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  overflow: hidden;
  z-index: -1; 
}

.flower {
  position: absolute;
  top: -10%;
  width: 8px;  /* 기본 크기 */
  height: auto;
  animation: fall linear forwards;
}
</style>

<script>

function createFlower() {
  const flower = document.createElement("img");
  flower.classList.add("flower");
  flower.src = "/static/img/flower.png"; 

  // 시작 위치 (랜덤 X 좌표)
  flower.style.left = Math.random() * 100 + "vw";

  // 크기 랜덤 (20~40px)
  const size = 5 + Math.random() * 12;
  flower.style.width = size + "px";

  // 속도 랜덤 (5~10초)
  const duration = 6 + Math.random() * 8;
  flower.style.animationDuration = duration + "s";

  // 사선 기울기 (좌우 ±10~20vw)
  const xMove = (Math.random() > 0.5 ? 1 : -1) * (10 + Math.random() * 10);

  // 개별 keyframes 생성
  flower.style.animationName = "fall-" + Date.now();
  const styleSheet = document.styleSheets[0];
  const rotate = 200 + Math.random() * 360; 
styleSheet.insertRule(`
  @keyframes ${flower.style.animationName} {
    0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) translateX(${xMove}vw) rotate(${rotate}deg); opacity: 0; }
  }
`, styleSheet.cssRules.length);

  document.getElementById("container").appendChild(flower);

  flower.addEventListener("animationend", () => flower.remove());
}

let flowerInterval;

function startFlowers() {
  if (!flowerInterval) {
    flowerInterval = setInterval(createFlower, 400);
  }
}

function stopFlowers() {
  clearInterval(flowerInterval);
  flowerInterval = null;
}

// 페이지가 보일 때만 꽃 생성
document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    stopFlowers();   // 탭 벗어나면 멈춤
  } else {
    startFlowers();  // 돌아오면 다시 시작
  }
});

// 처음 시작
startFlowers();


</script>
