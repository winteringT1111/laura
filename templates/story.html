{% load static %}

<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8">
        <title>Light of Laura</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
     
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="{% static 'css/effect/snow.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/effect/navbar.css' %}">
    </head>
    <body>
<div id="vn-container" style="position: relative; width: 800px; margin: 0 auto;">
    <!-- 배경 이미지 -->
    <img src="{% static 'img/bg1.png' %}" alt="배경" style="width: 100%; border-radius: 10px;">

    <!-- 대사창 -->
    <div id="dialogue-box" style="position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.7); color: white; padding: 20px; border-radius: 10px; box-sizing: border-box;">
        <h3 id="char-name" style="margin: 0; font-weight: bold; color: #ffd700;"></h3>
        <p id="char-text" style="margin-top: 10px; font-size: 18px; min-height: 60px;"></p>

        <!-- 다음 버튼 (대사창 안 오른쪽 아래) -->
        <button id="next-btn" 
                style="position: absolute; bottom: 15px; right: 20px; 
                       padding: 6px 12px; border-radius: 6px; 
                       background: none; color: white; border: none; cursor: pointer;">
            ▶
        </button>
    </div>
</div>

<script>
    const script = {{ script|safe }};
    let index = 0;

    const nameBox = document.getElementById("char-name");
    const textBox = document.getElementById("char-text");
    const nextBtn = document.getElementById("next-btn");

    let typing = false; // 타자기 효과 진행 중인지 여부
    let typingTimeout;  // setTimeout ID 저장용

    function showNextLine() {
        if (typing) {
            // 아직 문장 다 안 나왔는데 버튼 누른 경우 → 한 번에 완성
            completeLine();
            return;
        }

        if (index < script.length) {
            nameBox.textContent = script[index].name;
            textBox.textContent = "";
            typeWriter(script[index].text, 0);
            index++;
        } else {
            nextBtn.disabled = true;
            nextBtn.textContent = "처음으로";
            nextBtn.style.cursor = "default";
        }
    }

    // 타자기 효과
    function typeWriter(text, i) {
        typing = true;
        if (i < text.length) {
            textBox.textContent += text.charAt(i);
            typingTimeout = setTimeout(() => typeWriter(text, i + 1), 40);
        } else {
            typing = false; // 다 출력 완료
        }
    }

    // 타자기 효과를 즉시 완성
    function completeLine() {
        clearTimeout(typingTimeout);
        textBox.textContent = script[index - 1].text; // 현재 문장 전체 출력
        typing = false;
    }

    nextBtn.addEventListener("click", showNextLine);

    // 첫 대사 출력
    showNextLine();
</script>


    </body>


</html>




