<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ìŠ¤í‚¬ì²´í¬ ë°ëª¨</title>
<style>
  :root{
    --width: 540px;
    --height: 48px;
    --track-bg: #222;
    --zone-bg: linear-gradient(90deg,#75d89a,#3cb371);
    --indicator: #ffd166;
    --success-color: #28a745;
    --fail-color: #dc3545;
    --glass: rgba(255,255,255,0.04);
  }

  body{
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    background: linear-gradient(180deg,#0f1724,#071025);
    color: #e6eef8;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:28px;
    padding:24px;
  }

  .panel{
    width: calc(var(--width) + 40px);
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:14px;
    padding:20px;
    box-shadow: 0 6px 20px rgba(2,6,23,0.6);
    text-align:center;
  }

  h1{ margin:0 0 12px 0; font-size:18px; font-weight:600; color:#dceffd; }
  p.small{ margin:0 0 12px 0; color:#9fb1d6; font-size:13px; }

  .skill-check{
    width: var(--width);
    height: var(--height);
    background: var(--track-bg);
    border-radius:10px;
    position:relative;
    margin: 14px auto;
    box-shadow: inset 0 2px 6px rgba(0,0,0,0.7), 0 6px 18px rgba(2,6,23,0.5);
    overflow: hidden;
    display:flex;
    align-items:center;
  }

  /* ëª©í‘œ ì¡´ (green zone) */
  .zone{
    position:absolute;
    top:6px;
    height: calc(var(--height) - 12px);
    border-radius:8px;
    background: var(--zone-bg);
    box-shadow: 0 2px 8px rgba(0,0,0,0.55), inset 0 2px 8px rgba(255,255,255,0.03);
    pointer-events:none;
  }

  /* ì›€ì§ì´ëŠ” í‘œì‹œê¸° */
  .indicator{
    position:absolute;
    top:4px;
    width:14px;
    height: calc(var(--height) - 8px);
    border-radius:4px;
    background: var(--indicator);
    box-shadow: 0 2px 12px rgba(0,0,0,0.6);
    transform: translateX(0);
    transition: background 160ms, box-shadow 160ms;
  }

  /* í˜ì´ë“œ ë¼ì¸(ê°€ìš´ë° ê¸°ì¤€ì„ ) */
  .center-line{
    position:absolute;
    left:50%;
    top:0;
    bottom:0;
    width:1px;
    background: linear-gradient(180deg, transparent, rgba(255,255,255,0.06), transparent);
    transform: translateX(-0.5px);
    pointer-events:none;
  }

  .controls{
    display:flex;
    gap:8px;
    justify-content:center;
    margin-top:12px;
  }

  button{
    border:0;
    padding:10px 14px;
    border-radius:8px;
    font-weight:600;
    cursor:pointer;
    background:var(--glass);
    color:#dff0ff;
    box-shadow: 0 4px 12px rgba(2,6,23,0.5);
  }

  button.primary{
    background: linear-gradient(90deg,#25527a,#3b82c4);
  }

  .result{
    margin-top:12px;
    min-height:26px;
    font-weight:700;
    letter-spacing:0.2px;
  }

  .result.success{ color: var(--success-color); }
  .result.fail{ color: var(--fail-color); }

  /* ì˜µì…˜ ë¼ì¸ */
  .options{
    display:flex;
    gap:8px;
    justify-content:center;
    margin-top:10px;
    color:#9fb1d6;
    font-size:13px;
  }

  label{ display:flex; align-items:center; gap:6px; cursor:pointer; user-select:none; }
  input[type="range"]{ width:120px; }

  /* ì‘ì€ ë„ì›€ë§ */
  .hint{ color:#8fa8d0; font-size:12px; margin-top:8px; }
</style>
</head>
<body>
  <div class="panel" role="application" aria-label="ìŠ¤í‚¬ ì²´í¬ íŒ¨ë„">
    <h1>ìŠ¤í‚¬ì²´í¬ ë°ëª¨</h1>
    <p class="small">Startë¥¼ ëˆŒëŸ¬ ë°”ë¥¼ ì›€ì§ì¸ ë’¤ Stopì„ ëˆŒëŸ¬ ëª©í‘œ êµ¬ê°„ì— ë©ˆì¶”ë©´ ì„±ê³µ!</p>

    <div class="skill-check" id="track" aria-hidden="false">
      <div id="zone" class="zone" style="left: 38%; width: 18%;"></div>
      <div class="center-line" aria-hidden="true"></div>
      <div id="indicator" class="indicator" style="left:0;"></div>
    </div>

    <div class="controls">
      <button id="startBtn" class="primary" aria-pressed="false">Start</button>
      <button id="stopBtn" disabled>Stop</button>
      <button id="resetBtn">Reset</button>
    </div>

    <div class="options" aria-hidden="false">
      <label>ì†ë„ <input id="speed" type="range" min="0.6" max="3" step="0.1" value="1.6"></label>
      <label>ì¡´ ë„“ì´ <input id="zoneWidth" type="range" min="6" max="30" step="1" value="18"></label>
      <label><input id="autoReverse" type="checkbox"> ì™•ë³µ</label>
    </div>

    <div class="result" id="result" aria-live="polite"></div>
    <div class="hint">Tip: zone ë„“ì´, ì†ë„, ì™•ë³µ ì˜µì…˜ì„ ë°”ê¿” ë‚œì´ë„ ì¡°ì ˆ ê°€ëŠ¥.</div>
  </div>

<script>
/*
  ì‘ë™ ì›ë¦¬:
  - indicatorëŠ” ì‹œê°„ì— ë”°ë¼ 0~100%ë¡œ ì´ë™.
  - requestAnimationFrameìœ¼ë¡œ ë¶€ë“œëŸ½ê²Œ ì›€ì§ì„.
  - Start ëˆ„ë¥´ë©´ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘, Stop ëˆ„ë¥´ë©´ í˜„ì¬ ìœ„ì¹˜ë¡œ íŒì •.
  - 'ì™•ë³µ' ì˜µì…˜ì´ ì¼œì§€ë©´ ì¢Œìš° ë°˜ë³µ(ë˜ëŒì•„ì˜¤ê¸°)ë¡œ ì›€ì§ì„.
*/

(function(){
  const indicator = document.getElementById('indicator');
  const zoneEl = document.getElementById('zone');
  const startBtn = document.getElementById('startBtn');
  const stopBtn = document.getElementById('stopBtn');
  const resetBtn = document.getElementById('resetBtn');
  const speedInput = document.getElementById('speed');
  const zoneWidthInput = document.getElementById('zoneWidth');
  const autoReverseInput = document.getElementById('autoReverse');
  const resultEl = document.getElementById('result');
  const track = document.getElementById('track');

  let animId = null;
  let startTime = null;
  let pos = 0;            // 0 ~ 1
  let direction = 1;     // 1 ì˜¤ë¥¸ìª½, -1 ì™¼ìª½
  let running = false;

  // ì´ˆê¸° ì…‹ì—…: zone ìœ„ì¹˜/í¬ê¸° ë°˜ì˜
  function applyZone(){
    const leftPercent = 38; // ê¸°ë³¸ left
    const widthPercent = Number(zoneWidthInput.value); // ì‚¬ìš©ì ì¡°ì ˆ
    zoneEl.style.left = leftPercent + '%';
    zoneEl.style.width = widthPercent + '%';
  }
  applyZone();

  zoneWidthInput.addEventListener('input', ()=>{
    applyZone();
  });

  function setIndicatorPercent(p){
    p = Math.max(0, Math.min(1, p));
    const px = (track.clientWidth - indicator.clientWidth) * p;
    indicator.style.left = px + 'px';
    pos = p;
  }

  // ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
  function loop(ts){
    if(!startTime) startTime = ts;
    const elapsed = ts - startTime;
    const baseSpeed = Number(speedInput.value); // ë‹¨ìœ„: arbitrary
    // ì´ë™ëŸ‰: elapsed ë°€ë¦¬ì´ˆì— ë¹„ë¡€. (0.001 ì€ ê°ë„)
    const delta = baseSpeed * (elapsed / 1000) * 0.4;
    startTime = ts;

    // pos ë³€í™”
    if(autoReverseInput.checked){
      pos += delta * direction;
      if(pos >= 1){ pos = 1; direction = -1; }
      if(pos <= 0){ pos = 0; direction = 1; }
    } else {
      // ë°˜ë³µí•´ì„œ ì´ˆê¸°í™” (í•œ ë°©í–¥ìœ¼ë¡œ ëê¹Œì§€ ê°€ë©´ ë‹¤ì‹œ ì²˜ìŒìœ¼ë¡œ)
      pos += delta;
      if(pos >= 1) pos = 0;
    }

    setIndicatorPercent(pos);

    animId = requestAnimationFrame(loop);
  }

  startBtn.addEventListener('click', ()=>{
    if(running) return;
    running = true;
    startBtn.setAttribute('aria-pressed','true');
    stopBtn.disabled = false;
    resultEl.textContent = '';
    startTime = null;
    animId = requestAnimationFrame(loop);
  });

  stopBtn.addEventListener('click', ()=>{
    if(!running) return;
    running = false;
    startBtn.setAttribute('aria-pressed','false');
    stopBtn.disabled = true;
    if(animId) cancelAnimationFrame(animId);
    animId = null;

    // íŒì •: indicatorì˜ ì¤‘ì‹¬ì´ zone ë‚´ë¶€ì— ìˆëŠ”ì§€
    const trackRect = track.getBoundingClientRect();
    const indRect = indicator.getBoundingClientRect();
    const zoneRect = zoneEl.getBoundingClientRect();

    const indCenter = indRect.left + indRect.width/2;
    const zoneLeft = zoneRect.left;
    const zoneRight = zoneRect.left + zoneRect.width;

    const success = (indCenter >= zoneLeft && indCenter <= zoneRight);

    resultEl.className = 'result ' + (success ? 'success' : 'fail');
    resultEl.textContent = success ? 'ì„±ê³µ! ğŸ‰' : 'ì‹¤íŒ¨... ğŸ˜µâ€ğŸ’«';
    // ì‹œê°ì  íš¨ê³¼
    indicator.style.background = success ? 'var(--success-color)' : 'var(--fail-color)';
    indicator.style.boxShadow = success ? '0 6px 18px rgba(40,167,69,0.25)' : '0 6px 18px rgba(220,53,69,0.25)';

    // ì§§ì€ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ìƒ‰ ì›ìƒë³µêµ¬
    setTimeout(()=> {
      indicator.style.background = '';
      indicator.style.boxShadow = '';
    }, 700);
  });

  resetBtn.addEventListener('click', ()=>{
    if(animId) cancelAnimationFrame(animId);
    animId = null;
    running = false;
    startBtn.setAttribute('aria-pressed','false');
    stopBtn.disabled = true;
    setIndicatorPercent(0);
    resultEl.textContent = '';
  });

  // í‚¤ë³´ë“œ ì¡°ì‘ (ìŠ¤í˜ì´ìŠ¤ë¡œ Start/Stop toggle)
  window.addEventListener('keydown',(e)=>{
    if(e.code === 'Space'){
      e.preventDefault();
      if(!running) startBtn.click();
      else stopBtn.click();
    }
  });

  // íŠ¸ë™ í´ë¦­ìœ¼ë¡œ Stop (ì„ íƒì )
  track.addEventListener('click', ()=>{
    if(running) stopBtn.click();
  });

  // ë°˜ì‘í˜•: ì¸ë””ì¼€ì´í„° ìœ„ì¹˜ ì¡°ì •
  window.addEventListener('resize', ()=>{
    setIndicatorPercent(pos);
  });

})();
</script>
</body>
</html>
